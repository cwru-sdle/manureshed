<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sensitivity Analysis with Custom Efficiency Factors • manureshed</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis with Custom Efficiency Factors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">manureshed</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/scenario-comparison.html">Scenario Comparison</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/advanced-features.html">Advanced Features</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/custom-efficiency-analyis.html">Custom Efficiency Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/dashboard-guide.html">Interactive Dashboard</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/visualization-guide.html">Visualization Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/data-integration.html">Custom Data Integration</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/custom-efficiency-analyis.html">Custom Efficiency Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cwru-sdle/manureshed" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sensitivity Analysis with Custom Efficiency Factors</h1>
                        <h4 data-toc-skip class="author">Olatunde D.
Akanbi</h4>
            
            <h4 data-toc-skip class="date">2026-01-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cwru-sdle/manureshed/blob/HEAD/vignettes/custom-efficiency-analyis.Rmd" class="external-link"><code>vignettes/custom-efficiency-analyis.Rmd</code></a></small>
      <div class="d-none name"><code>custom-efficiency-analyis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates how to conduct sensitivity analysis using
custom nutrient efficiency factors in the manureshed package. While
standard analyses use established efficiency factors (0.5 for nitrogen,
1.0 for phosphorus), users may want to explore how different efficiency
assumptions affect classification results.</p>
</div>
<div class="section level2">
<h2 id="standard-vs--custom-efficiency-factors">Standard vs. Custom Efficiency Factors<a class="anchor" aria-label="anchor" href="#standard-vs--custom-efficiency-factors"></a>
</h2>
<p><strong>Standard Factors:</strong> - <strong>Nitrogen: 0.5
(50%)</strong> - Reflects typical losses during nutrient cycling,
application, and uptake - <strong>Phosphorus: 1.0 (100%)</strong> -
Assumes full phosphorus availability</p>
<p><strong>When to Use Custom Factors:</strong> - Evaluating improved
management practices (higher efficiency) - Accounting for regional
differences in application methods - Conducting uncertainty analysis -
Testing different policy scenarios</p>
</div>
<div class="section level2">
<h2 id="basic-sensitivity-analysis">Basic Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#basic-sensitivity-analysis"></a>
</h2>
<div class="section level3">
<h3 id="load-required-data">Load Required Data<a class="anchor" aria-label="anchor" href="#load-required-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://osf.io/g39xa/" class="external-link">manureshed</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load built-in data for HUC8 watersheds</span></span>
<span><span class="va">nugis_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_builtin_nugis.html">load_builtin_nugis</a></span><span class="op">(</span><span class="st">"huc8"</span>, <span class="fl">2016</span><span class="op">)</span></span>
<span><span class="va">boundaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_builtin_boundaries.html">load_builtin_boundaries</a></span><span class="op">(</span><span class="st">"huc8"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-different-nitrogen-efficiencies">Compare Different Nitrogen Efficiencies<a class="anchor" aria-label="anchor" href="#compare-different-nitrogen-efficiencies"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard analysis (50% efficiency)</span></span>
<span><span class="va">results_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>  <span class="va">nugis_data</span>, </span>
<span>  scale <span class="op">=</span> <span class="st">"huc8"</span>,</span>
<span>  n_efficiency <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  p_efficiency <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Improved management scenario (70% efficiency)</span></span>
<span><span class="va">results_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>  <span class="va">nugis_data</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"huc8"</span>, </span>
<span>  n_efficiency <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  p_efficiency <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conservative scenario (30% efficiency)</span></span>
<span><span class="va">results_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>  <span class="va">nugis_data</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"huc8"</span>,</span>
<span>  n_efficiency <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  p_efficiency <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare nitrogen classifications</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Standard (50% efficiency):\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">results_standard</span><span class="op">$</span><span class="va">N_class</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"\nImproved Management (70% efficiency):\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">results_high</span><span class="op">$</span><span class="va">N_class</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"\nConservative (30% efficiency):\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">results_low</span><span class="op">$</span><span class="va">N_class</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualize-sensitivity-results">Visualize Sensitivity Results<a class="anchor" aria-label="anchor" href="#visualize-sensitivity-results"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison data frame</span></span>
<span><span class="va">efficiency_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Efficiency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  Scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Conservative"</span>, <span class="st">"Standard"</span>, <span class="st">"Improved"</span><span class="op">)</span>,</span>
<span>  Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results_low</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Source"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results_standard</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Source"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results_high</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Source"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Sink_Deficit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results_low</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Sink_Deficit"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results_standard</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Sink_Deficit"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results_high</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Sink_Deficit"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot source watersheds across scenarios</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">efficiency_scenarios</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Efficiency</span>, y <span class="op">=</span> <span class="va">Source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span>, color <span class="op">=</span> <span class="st">"#2166ac"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"#2166ac"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Impact of Nitrogen Efficiency on Source Watersheds"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Nitrogen Efficiency Factor"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of Source Watersheds"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="phosphorus-sensitivity-analysis">Phosphorus Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#phosphorus-sensitivity-analysis"></a>
</h2>
<p>While phosphorus typically uses 100% efficiency, you can explore
alternative scenarios:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard phosphorus analysis</span></span>
<span><span class="va">results_p_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>  <span class="va">nugis_data</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"huc8"</span>,</span>
<span>  n_efficiency <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  p_efficiency <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reduced phosphorus availability scenario</span></span>
<span><span class="va">results_p_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>  <span class="va">nugis_data</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"huc8"</span>,</span>
<span>  n_efficiency <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  p_efficiency <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare phosphorus classifications</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Standard (100% P efficiency):\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">results_p_standard</span><span class="op">$</span><span class="va">P_class</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"\nReduced Availability (80% P efficiency):\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">results_p_reduced</span><span class="op">$</span><span class="va">P_class</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combined-sensitivity-analysis">Combined Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#combined-sensitivity-analysis"></a>
</h2>
<p>Analyze both nutrients simultaneously with custom efficiencies:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create multiple scenarios</span></span>
<span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  baseline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0.5</span>, p <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  improved_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0.7</span>, p <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  reduced_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0.5</span>, p <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  both_modified <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0.6</span>, p <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run all scenarios</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">scenarios</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">scenario_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">scenario</span> <span class="op">&lt;-</span> <span class="va">scenarios</span><span class="op">[[</span><span class="va">scenario_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>    <span class="va">nugis_data</span>,</span>
<span>    scale <span class="op">=</span> <span class="st">"huc8"</span>,</span>
<span>    n_efficiency <span class="op">=</span> <span class="va">scenario</span><span class="op">$</span><span class="va">n</span>,</span>
<span>    p_efficiency <span class="op">=</span> <span class="va">scenario</span><span class="op">$</span><span class="va">p</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Return summary statistics</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Scenario <span class="op">=</span> <span class="va">scenario_name</span>,</span>
<span>    N_Efficiency <span class="op">=</span> <span class="va">scenario</span><span class="op">$</span><span class="va">n</span>,</span>
<span>    P_Efficiency <span class="op">=</span> <span class="va">scenario</span><span class="op">$</span><span class="va">p</span>,</span>
<span>    N_Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Source"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    P_Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">P_class</span> <span class="op">==</span> <span class="st">"Source"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    N_Sink_Deficit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Sink_Deficit"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    P_Sink_Deficit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">P_class</span> <span class="op">==</span> <span class="st">"Sink_Deficit"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine results</span></span>
<span><span class="va">sensitivity_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">results_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_summary</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapping-results-across-scenarios">Mapping Results Across Scenarios<a class="anchor" aria-label="anchor" href="#mapping-results-across-scenarios"></a>
</h2>
<p>Visualize spatial differences between efficiency scenarios:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join with spatial boundaries</span></span>
<span><span class="va">spatial_standard</span> <span class="op">&lt;-</span> <span class="va">boundaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">results_standard</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"huc8"</span> <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spatial_high</span> <span class="op">&lt;-</span> <span class="va">boundaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">results_high</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"huc8"</span> <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create side-by-side maps</span></span>
<span><span class="va">map_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_agricultural_classification.html">map_agricultural_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">spatial_standard</span>, </span>
<span>  <span class="st">"nitrogen"</span>, </span>
<span>  <span class="st">"N_class"</span>,</span>
<span>  <span class="st">"Standard Efficiency (50%)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_agricultural_classification.html">map_agricultural_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">spatial_high</span>,</span>
<span>  <span class="st">"nitrogen"</span>,</span>
<span>  <span class="st">"N_class"</span>, </span>
<span>  <span class="st">"Improved Efficiency (70%)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display maps (requires cowplot or similar)</span></span>
<span><span class="co"># cowplot::plot_grid(map_standard, map_high, ncol = 2)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<p><strong>Key Considerations:</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Source Watersheds:</strong> Higher efficiency factors
typically increase the number of source watersheds as more nitrogen
becomes “available” for redistribution</p></li>
<li><p><strong>Sink Classification:</strong> Lower efficiencies may
shift some “within watershed” areas to deficit status</p></li>
<li>
<p><strong>Management Implications:</strong> Results inform
decision-making about:</p>
<ul>
<li>Required efficiency improvements to achieve redistribution
goals</li>
<li>Sensitivity of regional planning to efficiency assumptions</li>
<li>Infrastructure needs under different management scenarios</li>
</ul>
</li>
<li><p><strong>Uncertainty Quantification:</strong> Range of results
across scenarios indicates uncertainty due to efficiency
assumptions</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="recommended-practice">Recommended Practice<a class="anchor" aria-label="anchor" href="#recommended-practice"></a>
</h2>
<p>For publication or policy analysis, consider:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Report standard results</strong> using established
efficiency factors (0.5 for N, 1.0 for P)</li>
<li>
<strong>Conduct sensitivity analysis</strong> with reasonable
alternative values (e.g., Â±20%)</li>
<li>
<strong>Document assumptions</strong> clearly in methodology</li>
<li>
<strong>Discuss uncertainty</strong> based on sensitivity
results</li>
</ol>
</div>
<div class="section level2">
<h2 id="example-complete-sensitivity-workflow">Example: Complete Sensitivity Workflow<a class="anchor" aria-label="anchor" href="#example-complete-sensitivity-workflow"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define efficiency range for nitrogen</span></span>
<span><span class="va">n_efficiency_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run sensitivity analysis</span></span>
<span><span class="va">sensitivity_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">n_efficiency_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agri_classify_complete_custom.html">agri_classify_complete_custom</a></span><span class="op">(</span></span>
<span>    <span class="va">nugis_data</span>,</span>
<span>    scale <span class="op">=</span> <span class="st">"huc8"</span>,</span>
<span>    n_efficiency <span class="op">=</span> <span class="va">eff</span>,</span>
<span>    p_efficiency <span class="op">=</span> <span class="fl">1.0</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    N_Efficiency <span class="op">=</span> <span class="va">eff</span>,</span>
<span>    N_Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Source"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    N_Sink_Deficit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Sink_Deficit"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    N_Within_Watershed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">N_class</span> <span class="op">==</span> <span class="st">"Within_Watershed"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine and visualize</span></span>
<span><span class="va">sensitivity_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sensitivity_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create sensitivity plot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">sensitivity_long</span> <span class="op">&lt;-</span> <span class="va">sensitivity_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N_Source</span>, <span class="va">N_Sink_Deficit</span>, <span class="va">N_Within_Watershed</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"Classification"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"Count"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Classification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"N_"</span>, <span class="st">""</span>, <span class="va">Classification</span><span class="op">)</span>,</span>
<span>    Classification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span>, <span class="va">Classification</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sensitivity_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N_Efficiency</span>, y <span class="op">=</span> <span class="va">Count</span>, color <span class="op">=</span> <span class="va">Classification</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Nitrogen Classification Sensitivity to Efficiency Factor"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Nitrogen Efficiency Factor"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of Watersheds"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Classification"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Custom efficiency factors enable: - <strong>Sensitivity
analysis</strong> to quantify uncertainty - <strong>Scenario
planning</strong> for different management practices<br>
- <strong>Regional adaptation</strong> for varying agricultural systems
- <strong>Policy evaluation</strong> under different assumptions</p>
<p>For most applications, standard factors (N: 0.5, P: 1.0) remain
appropriate, but sensitivity analysis provides valuable context for
interpreting results and informing decision-making.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Spiegal et al. (2020). Manuresheds: Advancing nutrient recycling in
US agriculture</li>
<li>Flynn et al. (2023). Manureshed nutrient balances at watershed
scales</li>
<li>Akanbi et al. (2025). Towards circular nutrient economies:
Integrated framework</li>
</ul>
<p>For more information on standard manureshed methodologies, see
<code><a href="../articles/getting-started.html">vignette("getting-started")</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0000-0001-7719-2619" class="external-link">Olatunde D. Akanbi</a> et al. at Case Western Reserve University</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and <a href="https://www.r-project.org/" class="external-link">R</a></p>
</div>

    </footer>
</div>





  </body>
</html>
